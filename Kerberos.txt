Kerberos

    O Kerberos √© um protocolo de autentica√ß√£o de rede projetado para permitir que duas partes (como um cliente e um servidor) comprovem sua identidade de forma segura em uma rede insegura, como a internet ou uma rede corporativa.
    Foi desenvolvido pelo MIT nos anos 1980 e nomeado em homenagem ao C√©rbero (Kerberos), o c√£o de tr√™s cabe√ßas da mitologia grega que guardava o submundo ‚Äî simbolizando a prote√ß√£o contra acessos n√£o autorizados.

Kerberos √© como um porteiro digital confi√°vel que garante que:

    Voc√™ √© quem diz ser (sem mandar sua senha o tempo todo);
    Os servi√ßos que voc√™ acessa tamb√©m s√£o confi√°veis;
    Tudo isso acontece de forma criptografada e sem enviar senhas pela rede.

Onde o Kerberos √© usado?

    Windows (Active Directory): √© o protocolo de autentica√ß√£o padr√£o.
    Linux/Unix: amplamente usado em ambientes com autentica√ß√£o centralizada.
    Servi√ßos corporativos: Hadoop, PostgreSQL, Apache, Samba etc.
    Educa√ß√£o e governo: institui√ß√µes que precisam de autentica√ß√£o forte e centralizada.

=========================================================================================================================================

Como o Kerberos funciona? (Explicado em etapas)

    Kerberos √© um protocolo de autentica√ß√£o baseado em tickets que permite que usu√°rios acessem recursos de rede sem precisar enviar senhas pela rede. Ele usa criptografia de chave sim√©trica e funciona com base na confian√ßa em um servidor central chamado KDC (Key Distribution Center).

Principais componentes do Kerberos:

Componente	        Fun√ß√£o
Cliente	            Usu√°rio ou sistema que deseja acessar um servi√ßo.
Servi√ßo	            Servidor ou aplica√ß√£o que o cliente quer acessar.
KDC                 (Key Distribution Center)	Servidor central que autentica usu√°rios e emite tickets.
AS                  (Authentication Server)	Parte do KDC que autentica o cliente e emite o TGT.
TGS                 (Ticket Granting Service)	Parte do KDC que emite tickets para servi√ßos com base no TGT.
TGT                 (Ticket Granting Ticket)	Um ticket que comprova que o cliente foi autenticado com sucesso.
Ticket de servi√ßo	Um ticket que permite acessar um servi√ßo espec√≠fico (ex: servidor de arquivos).


Etapas do funcionamento do Kerberos (Passo a passo):

üî∏ 1. O usu√°rio faz login (kinit / login no Windows)

        O cliente insere o nome de usu√°rio e a senha.
        A senha nunca √© enviada pela rede ‚Äî ela √© usada para gerar uma chave que criptografa a comunica√ß√£o.

üî∏ 2. Cliente ‚Üí AS (Solicita TGT)

        O cliente envia ao Authentication Server (AS):
        Seu nome de usu√°rio.
        Nome do servi√ßo de autentica√ß√£o (TGS).
        Marca de tempo (timestamp) criptografada.

üî∏ 3. AS ‚Üí Cliente (Retorna o TGT)

O AS verifica o usu√°rio e responde com:

        Um TGT criptografado com a chave do TGS.
        Uma chave de sess√£o para uso entre o cliente e o TGS.
        O TGT √© como um "passe VIP" que permite ao cliente pedir tickets para servi√ßos, sem reautenticar com a senha.

üî∏ 4. Cliente ‚Üí TGS (Solicita ticket de servi√ßo)

        Quando o cliente quer acessar um servi√ßo (ex: servidor de arquivos), ele envia:
        O TGT recebido.
        Nome do servi√ßo desejado.
        Um timestamp criptografado com a chave de sess√£o.

üî∏ 5. TGS ‚Üí Cliente (Retorna ticket de servi√ßo)

        O TGS responde com:
        Um ticket de servi√ßo, v√°lido apenas para o servi√ßo solicitado.
        Outra chave de sess√£o para comunica√ß√£o com o servi√ßo.

üî∏ 6. Cliente ‚Üí Servi√ßo (Acessa o recurso)

        O cliente agora envia:
        O ticket de servi√ßo.
        Um novo timestamp criptografado.
        Se tudo estiver correto, o servi√ßo permite o acesso ‚Äî sem pedir senha novamente.

Resultado final:

    Voc√™ acessa recursos da rede de forma segura, r√°pida e sem enviar senhas diretamente.
    Isso tudo √© poss√≠vel gra√ßas ao TGT e os tickets de servi√ßo, que provam sua identidade.

=====================================================================================================================================

TGT

O que √© o TGT (Ticket Granting Ticket)?

    O TGT (Ticket de Concess√£o de Tickets) √©:
    Um ticket criptografado emitido pelo KDC (Key Distribution Center), mais especificamente pelo AS (Authentication Server).
    Ele prova que o usu√°rio foi autenticado com sucesso.
    √â usado para solicitar outros tickets (como o TGS ‚Äì Ticket Granting Service) sem precisar reautenticar com senha repetidamente.

Como funciona o TGT no processo de autentica√ß√£o?

    Login do usu√°rio: O usu√°rio fornece seu nome de usu√°rio e senha.
    Requisi√ß√£o de TGT: O cliente (por ex., o computador do usu√°rio) solicita um TGT ao AS do KDC.
    Resposta do AS: 
        O AS autentica o usu√°rio (verificando a senha contra um hash armazenado) e retorna:

            Um TGT criptografado com a chave do TGS.
            Um sess√£o key (chave de sess√£o) para o cliente se comunicar com o TGS.

    Solicita√ß√£o de acesso a servi√ßos: Quando o usu√°rio quer acessar um servi√ßo (ex: um servidor de arquivos), o cliente usa o TGT para solicitar ao TGS um ticket de servi√ßo.
    TGS emite o ticket de servi√ßo, que o cliente usa para autenticar-se no servi√ßo desejado.

Seguran√ßa do TGT

    O TGT √© v√°lido por um tempo limitado (ex: 10 horas) e pode ser renovado, dependendo da pol√≠tica.
    Ele n√£o cont√©m a senha do usu√°rio, apenas a prova de que o usu√°rio foi autenticado.
    Ele √© criptografado, de modo que s√≥ o TGS pode l√™-lo.

Exemplo pr√°tico

    Voc√™ entra no seu computador da empresa.
    O sistema solicita e recebe um TGT.
    Mais tarde, quando voc√™ acessa o servidor de arquivos ou o e-mail corporativo, o sistema usa o TGT para obter os tickets necess√°rios ‚Äì sem pedir sua senha novamente.


Fluxograma Simplificado do Kerberos com TGT:

[1] Usu√°rio faz login
        |
        v
[2] Requisi√ß√£o de TGT ao KDC (AS)
        |
        v
[3] AS retorna TGT + sess√£o key
        |
        v
[4] Cliente armazena TGT
        |
        v
[5] Cliente solicita ticket de servi√ßo (TGS) usando o TGT
        |
        v
[6] TGS retorna ticket de servi√ßo
        |
        v
[7] Cliente usa ticket de servi√ßo para acessar o servi√ßo desejado


=====================================================================================================================================================

Resumo visual do fluxo:

[1] Login ‚Üí Cliente ‚Üí AS: Requisi√ß√£o de TGT
[2] AS ‚Üí Cliente: TGT + chave de sess√£o
[3] Cliente ‚Üí TGS: Requisi√ß√£o de ticket de servi√ßo com TGT
[4] TGS ‚Üí Cliente: Ticket de servi√ßo
[5] Cliente ‚Üí Servi√ßo: Envia ticket de servi√ßo
[6] Servi√ßo ‚Üí Libera acesso

‚ö†Ô∏è Requisitos importantes:

Requisito	                            Por qu√™?
‚è∞ Rel√≥gio sincronizado (NTP)	    Kerberos depende de timestamps (prote√ß√£o contra replay attacks).
üèõÔ∏è KDC confi√°vel e dispon√≠vel	    Toda autentica√ß√£o depende dele.
üîê Chaves secretas protegidas	    A seguran√ßa depende das chaves sim√©tricas.

